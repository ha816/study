# 스프링 프레임워크

스프링 프레임워크는 POJO(Plain Old Java Object)를 생성 및 관리하는 애플리케이션 컨텍스트(DI 컨테이너)라는 핵심 컨테이너에서 의존성 주입을 이용해 애플리케이션을 작동한다. 

POJO는 복잡한 프레임워크용 인터페이스를 구현하거나 앱클리케이션에서 사용하려는 추상 클래스를 확장하는 것 같은 불필요한 제한이 없다는 장점이 있다. 

POJO라는 개념은 초기 부터 EJB(Enterprise Java Beans)를 고려해 만들어졌다. 기존에는 단순한 도메인 객체인데도 복잡한 패턴을 따라야 하므로 애플리케이션 서버에서 사용하려면 여러 인터페이스를 구현해야 했다. 코드는 손상되기 쉽고 테스트하기 어려워 졌다. 

결국 이런 문제 대문에 스프링 같은 프레임워크가 만들어 졌다. 

## 스프링의 핵심 기능과 애플리케이션 컨텍스트

> 스프링에서 의존성 주입은 어떻게 하는가?

의존성 주입은 전략 패턴(Strategy Pattern)을 따른 방법이다. 스전략 패턴을 사용하면 특정 구현 객체에 국한 되지 않고 외부에서 주입해준 객체를 사용하기 때문에 결합도가 낮아진다. 

스프링에서는 애플리케이션 컨텍스트(DI 컨테이너)라는 외부 컨테이너에서 애플리케이션에서 사용하려는 객체를 생성, 관리, 주입을 한다. 

애플리케이션 컨텍스트에서 다루는 모든 인스턴스를 빈(Bean)이라 한다. 애플리케이션 컨텍스트를 생성할때는 사용할 빈을 설정해야 한다. 이때 자바 기반 설정 방식, XML 기반 설정 방식, 컴포넌트 스캔 기반 설정 방식이 있다. 
```
ApplicationContext context = new AnnotationConfigApplicationContext(config.class); //config 클래스는 @Configuration 애너테이션을 클래스 상단에 붙이고 @Bean 애너테이션을 사용할 객체를 생성하는 메서드마다 붙인다.
ApplicationContext context = new ClasspathXmlApplicationContext(config.xml); //config.xml에 있는 정보로 컨텍스트를 생성한다. <bean> 태그로 필요한 빈들을 설정한다.
```

컴포넌트 스캔 설정 방식은 DI 컨테이너에서 관리할 빈 자체에 빈을 정의하는 애너테이션을 부여한다. **이 애너테이션이 붙은 클래스를 탐색해서 DI 컨테이너에 자동으로 등록하는데 이를 컴포넌트 스캔(Component Scan)이라고 한다.** 또한 의존성 주입도 이제까지 처럼 명시적으로 설정하는 것이 아니라 **애노테이션이 붙어 있으면 DI 컨테이너가 자동으로 필요로 하는 의존 컴포넌트를 주입하며 이를 오토 와이어링(Auto Wiring)이라 한다.**

자바 기반 설정 방식과 XML 기반 설정 방식이 있는데 @ComponentScan을 @Configuration이 붙은 설정 클래스에 붙이는 것이 자바 기반 설정 방식이다. XML기반은 `<context:component-scan>` 태그요소의 base-packages 속성으로 스캔범위를 결정한다. 
```
<beans
	xlms=...
	...
	<context:component-scan base-package="com.example.demo" />
</beans>
```

> 스코프란 무엇인가?

기본적으로 스프링 빈은 애플리케이션 컨텍스트 초기화될 때 생성되는데, 이를 eager Instantiation이라고 한다. 그리고 특별한 설정이 없으면 스프링 빈 인스턴스는 하나만 생성되며, 이를 싱글턴 스코프라고 한다. 

DI 컨테이너가 싱글턴 빈을 제공할때는 이 빈이 여러 인스턴스에서 이용한다는 것을 고려해야 하기 때문에, 스레드 세이프 해야 한다. 

싱글턴 스코프를 사용하느게 아니라 새 인스턴스를 받고 싶다면 prototype을 사용하면 된다. 그러면 DI 컨테이너에서 getBean 메서드를 호출할때마다 새 인스턴스가 반환된다. 이를 프로토타입 빈 스코프(prototype scope)라고 한다.

특정 HTTP 요청이 살아있는 동반 빈이 살아있는 리퀘스트(request scope), HTTP의 세션이 존재하는 동안만 존재하는 세션(session scope) 같은 다른 스코프도 존재한다. 

> AutoWiring이란 무엇인가?

간단히 말하면, DI 컨테이너가 자동으로 의존성 주입을 해주는 방법이다. 빈 컨테이너가 제공하는 빈을 특정 클래스에서 사용하고 싶어 의존성 주입을 자동으로 받을때 사용하는 방법이다. @Autowired을 세터 메서드, 생성자, 필드에 붙이면 빈 컨테이너로부터 필요한 객체를 주입받을 수 있다. 

클래스에 외부에서 접근 가능한 생성자나 세터 메서드가 없더라도 필드에 @Autowired를 붙일 수 있는데 심지어 private 필드일지라도 적절한 인스턴스를 오토 와이어 한다. DI 컨테이너가 이 클래스가 생성된 후에 리플렉션(reflection)을 이용하여 이 필드에 인스턴스를 오토 와이어 한다.




<!--stackedit_data:
eyJoaXN0b3J5IjpbLTYyNzYzMTE0NiwtMTQyMzk3OTY0NSwxNj
YyMDg5NzMxLC0xMjQ0MDg5NDEyLC0xMjU5NDk2MTQxLDEwNzYy
NjEwMjUsLTYwMzg2NDczLC03ODYwNDcxOV19
-->