# 카프카의 대표적인 기능

카프카의 대표적인 기능으로 떠올릴 수 있는 것은 메시지 큐 제품/ 로그 수집 /ETL 도구 등 예전부터 존재했던 몇몇 제품의 대체라고 할 수 있다. 

대부분 이전 제품에서 더 이상 취급하지 못할 정도로 대량의 데이터를 처리해야 할때 카프카를 검토했다고 생각하면 되겠다. 

아래는 카프카의 대표적인 기능이다. 

* 데이터 허브
	* 여러 시스템 사이에서 데이터를 상호교환한다.
* 로그 수집
	* BI 도구를 이용한 리포팅과 인공지능 분석을 위해 여러 서버에서 생성된 로그를 수집하고 축적할 곳엔 연결한다.
* 웹 활동 분석
	* 실시간 대시보드와 이상 탐지/부정 검출등 웹에서 사용자 활동을 실시간 파악한다.
* 사물인터넷
	* 센서등 다양한 디바이스에서 보낸 데이터를 수신해서 처리한 후 디바이스에 송신한다.
* 이벤트 소싱
	* 데이터에 대한 일련의 이벤트를 순차적으로 기록하고 CQRS 방식으로 대량의 이벤트를 유연하게 처리한다.

물론 위에서 열거한 모든 기능과 특징을 전부 사용하는 것은 드물다. 카프카는 유연한 구조이기 때문에 사례마다 다른 요구 사항을 토대로 기능을 취사 선택하거나 요구사항에 맞게 설정하는 경우가 많다. 

# 카프카 특징 복습

카프카는 대량의 데이터를 높은 처리량으로 실시간 처리 하기 위한 제품이다. 카프카의 아키텍처는 변함 없이 데이터 상호 교환을 위한 기반으로 발전해 왔다. 현재 카프카가 데이터를 전달하는 파이프라인 그 자체를 구성하기 위한 기반이라고 말한다. 

다시 한번 카프카로 실현할 수 있는 4가지 특성을 알아보자.

* 확장성
	* 여러 서버로 확장이 가능하기 때문에 데이터 양에 따라 시스텀 확장이 가능하다.
* 영속성
	* 수신한 데이터를 디스크에 유지할 수 있기 때문에 언제라도 데이터를 읽을 수 있다.
* 유연성
	* 연계할 수 있는 제품이 많아 제품이나 시스템을 연결하는 허브 역할을 한다.
* 신뢰성
	* 메시지 전달 보증을 하므로 데이터 분실을 걱정하지 않아도 된다.

카프카는 위 4가지 실현을 위한 아키텍처로 Pub/Sub 메시지 모델에 기반한다. 메세지 큐 모델과는 달리 동일한 메시지를 여러 곳에 전달하는 이른바 동보 전송도 가능하다. 특히 메세지를 토픽에 포함된 파티션 단위로 한정하면 메시지의 순서 보증 실현도 가능하다. 

이러한 특성을 바탕으로 대량의 데이터를 처리해야 할때, 카프카의 각 기능과 특징이 중시되는 상황을 정리하면 아래와 같다.

* 실시간
	* 긴급성이 요구되거나 데이터를 즉시 사용하는 경우
* 동보 전송
	* 하나의 동일한 데이터를 후속의 여러 시스템에서 사용하는 경우, 데이터를 전달하는 관계 시스템이 단계적으로 증가하는 경우
* 영속성 
	* 데이터를 버퍼링 해야하는 경우나 처리 시산 간격이 다른 복수의 처리와 관련된 경우
* 다수의 제휴제품
	* 사용하는 제품이 균일하지 않고 다양한 경우도 가능
* 송수신 보증
	* 데이터 손실이 허용되지 않는 경우
* 순서 보증
	* 데이터 소스에 있어 데이터의 생성 순서를 중시하여 순서에 따른 판단과 제어를 수반하는 경우


# 데이터 허브

데이터 허브란 여러 데이터 소소를 제공하는 시스템에서 데이터를 수집하여 여러 시스템에 전달하는 아키텍처를 말한다. 

## 데이터 허브에서 다룰 문제

독립된 시스템이 많은 회사는 각 시스템 간 데이터 연계를 어떻게 할것인지에 대한 문제가 있다 그러한 문제로 아래와 같이 고려할 사항들이 있다.

* 데이터 형식은 무엇이 좋은지? CSV?
* 데이터 송신 시간은 하루에 한번?
* 상대 시스템이 배포 중일땐 어떻게 할지
* 장애가 발생했을때 데이터를 잃지 않기 위해서...?

예를 들어 처음 한 개의 연계 허브 시스템이 있고 이것이 3개의 송신처와 연결된다고 가정하자. 이 과정에서 3개의 각 시스템 별로 연계를 하려면 상당한 시간과 노력이 든다. 

그렇게 만들었다고 해도 추가 연계 시스템이 늘어난다면 또 수습할 일이 생긴다. 이 처럼 시스템이 분리되어 시스템 간의 연계를 효율적으로 할수 없는 상황을 **사일로(silo)**화 되었다고 한다.

[사일로
](https://m.blog.naver.com/PostView.nhn?blogId=jskimco&logNo=60178713431&proxyReferer=https://www.google.com/)

사일로화된 시스템은 IT 기술 보급과 함께 전세계적으로 발생했다. 그리고 사일로화 문제를 해결하기 위해 여러 솔루션도 개발되었다. 

사일로 현상을 피하기 위해선 아래와 같은 과제를 해결해야 한다.

* 데이터 소스에서 생성된 동일한 데이터를 여러 시스템에서 이용한다. 
* 후속 시스템마다 데이터를 필요로 하는 시기와 빈도가 다르다. 
* 접속원이나 연결 시스템에서 이용되는 연계방식이 제각각이다. 
* 데이터 분실을 허용하지 않는다. 

## 카프카로 데이터 허브 구현하기 








> Written with [StackEdit](https://stackedit.io/).
<!--stackedit_data:
eyJoaXN0b3J5IjpbLTE1MTQ5MzY1NzgsMTU3NTczMjUzMiwtMj
QxMjgyMzQsLTE1MjA3MjU3MTgsNzMwOTk4MTE2XX0=
-->