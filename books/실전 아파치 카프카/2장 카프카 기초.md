# Overview

이 장에서는 카프카의 메시지 송수신 구조와 카프카를 이용하는데 알아야할 기본 용어를 설명한다. 카프카는 여러 구성 요소로 이루어져 있어 개별 구성 요소를 파악하는 것만으로는 전체적인 그림을 이해하기 어렵다. 개요부터 시작하여 내부동작까지 단계적 설명을 하겠다. 주요 내용은 아래와 같다. 

1. 메시지 송수신 기본
2. 시스템 구성
3. 분산 메시징을 위한 구조
4. 데이터 견고함을 담보하는 복제의 구조

각 항목은 카프카를 이용하는데는 기본적인것들이지만, 1~3번은 카프카를 이용한 개발자나 사용자에게 중요하고 4번은 카프카를 이용한 플랫폼 설계, 운용 엔지니어에게 더 중요하다. 

# 메시지 송수신 기본

우선 카프카의 기본이 되는 데이터 중계를 위한 시스템 논리 구성을 알아보자.  시스템 구성 및 내부 동작 등 물리적 구성은 다음 절 이후에서 설명하므로 우선 논리적 구성과 기본 용어를 파악해보자. 

카피카의 주요 구성요소 

브로커(Broker) 
- 데이터를 송신,수신하는 서비스

메세지
- 카프카에서 다루는 데이터의 최소 단위, 카프카가 중계하는 로그의 한줄 한 줄과 센서 데이터 등이 이헤 해당한다. 메시지는 Key와 Value를 갖게 되며 나중에 언급할 메시지 전송할때 파티셔닝에 이용

프로듀서
- 데이터의 생산자이며 브로커에 메시지를 보내는 애플리케이션

컨슈머
- 브로커에서 메시지를 취득하는 애플리케이션

토픽
- 메시지의 종류를 토빅이라고 부른다. 
- 토픽은 메세지 종류를 관리하는 스토리지로도 여겨지며, 브로커에 배치되어 관리된다. 프로듀서와 컨슈머는 특정 토픽을 지정하여 메시지를 송수신함으로써 단일 카프카 클러스터에서 여러 종류의 메세지를 중계한다. 

# 시스템 구성

지금까지 메시지 전달에 필요한 각 구성요소의 논리 구성에 대해 살펴봤다. 이러한 구성요소를 동작시키는데 필요한 시스템 구성은 아래와 같다. 

이제 각 요소를 하나하나 자세히 알아보자.

## 브로커

브로커는 하나의 서버(또는 인스턴스) 당 하나의 데몬 프로세스로 동작하여 메시지 수신/전달 요청을 받아들인다. 이것을 여러 대의 클러스터로 구성할 수 있으며 브로커(리로스)를 추가할 수 있어 수신/전달 처리량의 향상을 스케일 아웃할 수 있다. 

브로커로 받은 데이터는 모두 디스크에 저장하여(영속화)가 이루어지기 때문에 디스크의 용량 만큼 데이터를 장기간 보존할 수 있다. 


## 프로듀서 API/ 컨슈머 API

프로듀서/컨슈머를 구현하는 기능은 브로커로 데이터를 보내고 브로커에서 데이터를 받기 위한 라이브러리로 제공된다. 프로듀서를 구현하기 위한 API를 프로듀서 API, 컨슈머를 구현하기 위한 API를 컨슈머 API라 한다. 

그러나 프로듀서, 컨슈머는 브로커 처럼 데몬 프로세스로 동작하는 프로그램은 아니며 각각 API는 자바이다. 

### 프로듀서

프로듀서는 프로듀서 API를 사용하여 브로커에 데이터를 송신하기 위해 구현된 애플리케이션이다. 


> Written with [StackEdit](https://stackedit.io/).
<!--stackedit_data:
eyJoaXN0b3J5IjpbLTEzNDA4ODU2MDcsLTEwMjM1NTQ5MzAsLT
E3MTEzODEyMjMsLTIwNDg3MDMwODgsLTMwODU0MjE5OSwtOTc1
NzAwMjE1LC0yNTY3MDQxMTQsOTM3NDIyODg3LC0xNjU5MTk3MT
QxLDE2MDkzMTM2MywtMTcxNTI2Nzk2OSw4Mzc5MjM5ODVdfQ==

-->