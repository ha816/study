
# 26장 코드 튜닝 기법

이 장에서는 속도 향상에 대한 내용을 중점적으로 소개하고 코드를 작게 만드는 몇 가지 팁을 소개한다. 일반적으로 성능은 속도와 크기 모두를 말하지만, 크기 감소는 코드를 튜닝하는 것보다는 클래스와 데이터를 재설계하는것으로 영향을 더 받는다. 코드 튜닝은 큰 규모설계에 변경보다는 작은 규묘의 변경을 말한다. 


## 26.1 논리 구조

프로그래밍의 상당 부분은 논리 구조를 다루는 작업으로 이루어진다. 

### 답을 알고 있을때는 테스트를 중단하라

```
if(5<x && x < 10) then
```
x가 5보다 크다는게 결정되면 그 이후의 테스트는 수행할 필요가 없다. 

### 빈도에 따른 테스트 정렬

가장 빠르고 참일 가능성이 가장 큰 테스트가 맨 먼저 수행되도록 테스트를 정렬한다. 보통 Case 문과 if-then-else문에 적용된다.

최적화된 코드에서는 가장 흔한 경우가 대개 더 일찍 발견 되기 때문에 전체적으로 보면 더 적은 테스트를 수행하는 결과가 된다. 

### 복잡한 표현식을 테이블 참조로 대체하라

어떠 환경에서는 복잡한 논리 구조를 상세하게 따지는 것보다 테이블 참조가 더 빠를 수 있다. 복잡하게 연결됐다는 것은 대개 무언가를 분류하고 나서 그 범주를 기반으로 작업을 수행하고자 하는 것이다. 

```
if( (a && !c) || (a && b)){
	category = 1;
} else if((b && c) || (c && !b)){
	category = 2;
} else if() //
```
위에 처럼 복잡한 논리 구조를 따르는 것보다...

``` 
categoryTable [][][] // 테이블 정의를 통해서 복잡한 논리구조를 쉽게 읽게 한다.
```

### 소극적 평가를 사용하라

소극적 평가(lazy evaluation)를 하면 작업이 정말 필요해질때 까지 어떠한 작업도 하지 않는다. 소극적 평가는 필요한 순간에 작업하는 JIT(Just in Time) 전략과 유사하다. 

가령 5000개의 값이 테이블이 있고 프로그램 시작시 테이블 값을 생성한 다음, 프로그램이 실행되면서 그것을 사용하는 프로그램이 있다고 하자. 그런데 그중 테이블의 일부만 사용한다면 필요할때만 사용하는 것이 중요하다. 

## 26.2 반복문

반복문은 여러 번 수행되기 때문에 프로그램에서 문제가 발생하는 영역이 확률이 높다. 

### 스위칭 해제 

스위칭은 반복문이 실행될때마다 반복문내에서 무언가를 결정하는 것을 말한다. 
반복문이 실행되는 동안 결정이 변하지 않는다면 반복문 밖에서 결정함으로써 불필요하게 스위칭하지 않게 할 수 있다. 

```
스위칭 되는 반복문을 작성
for(){
	if(condition1){
		...
	} else if(){
		...
	}
}
```

condition1 조건이 항상 같다면, 굳이 반복문 안에서 테스트를 할 필요가 없다. 

```
스위칭 해제한 반복문
if(condition1){
	for(){}
} else if(condition2){
	for(){}
}
```

사실 이 코드는 여러가지 좋은 프로그래밍 규칙을 위반한다. 가독성과 유지보수 편의성이 더 중요한데, 성능을 위해서 다른 규친과 트레이드 오프를 하고 있다. 게다가 비주얼 베이직에서는 이런 튜닝후 눈에 띄는 성능향상이 없었다. **따라서 어떠한 최적화는 효과를 확인하려면 반드시 측정을 해야 한다.**






> Written with [StackEdit](https://stackedit.io/).
<!--stackedit_data:
eyJoaXN0b3J5IjpbLTE4NTMzNDgxMzAsLTU3NTIyNjI1NywtMT
Y3MzU1MjQwMCw0OTUzNTc2ODQsMjAzMTg2NDA2NywtMjcwNTU4
MTM5LC0xOTMwMzU2MDY5LDgzNzExNTY4MywxNjQ3Mzk2MTQxLC
0xOTc1Mzk0NTc2LDMwMjE1MjMxNSwxNjQ5ODAwOTMwXX0=
-->