# 확률의 곱샘정리

확률의 곱샘 정리는 조건부 확률과 밀접한 연관이 있다. 

먼저 조건부 확률은 아래의 식으로 나타낸다. 
두 사건 A, B에 대해 
$$ P(A|B) = \cfrac {P(A \cap B)}{P(B)}$$

위의 식에서 $P(B)$를 좌항으로 옮기면 
$$ P(B)P(A|B) = P(A \cap B)$$

즉 위의 식을 확률의 곱샘정리라고 한다.  두 사건 A와 B 가 동시에 발생할 확률은 $P(B)P(A|B)$ 조건부 확률을 이용하여 표현할 수 있다. 

다음으로 확률의 곱생정리를 확장한 '조건부확률의 연쇄법칙'을 공부해보자 

## 조건부확률의 연쇄법칙(chain rule for conditional probability)

우리는 곱생정리에 따라서 두 사건 A, B에 대해 
$$ P(A|B) = \cfrac {P(A \cap B)}{P(B)}$$임을 알고 
따라서 $$ P(A \cap B) =  P(B) P(A|B)$$ 인것을 안다.

이것을 단순히 두사건 A,B가 아닌 훨씬 많은 사건에 대해 확장해보자.

n개의 사건 $A_1, A_2, \cdots, A_n$이 발생가능하면,
$$P(A_1 \cap A_2 \cap A_3 ... \cap A_n)$$ 
$$= P(A_2 \cap .\cdots. \cap A_n)P(A_1|A_2 \cap A_3 \cap ... \cap A_n)
$$
$$= P(A_3 \cap \cdots \cap A_n)P(A_2|A_3 \cap \cdots \cap A_n)
P(A_1|A_2 \cap A_3 \cap ... \cap A_n)
$$
$$
\cdots
$$
$$= P(A_{n-1} \cap A_{n}) P(A_{n-2}|A_{n-1} \cap A_{n}) \cdots P(A_1|A_2 \cap A_3 \cap ... \cap A_n)
$$
$$= P(A_{n}) P(A_{n-1}|A_n)P(A_{n-2}|A_{n-1} \cap A_{n}) \cdots P(A_2|A_3 \cap \cdots \cap A_n)P(A_1|A_2 \cap A_3 \cap ... \cap A_n)
$$

위와 같은 전개를 조건부확률의 연쇄법칙이라고 한다. 헷갈리니 예제를 들어 좀더 공부하자


$$P(A_1 \cap A_2 \cap A_3 \cap A_4)$$ 
는 다양한 연쇄 법칙을 적용시킬수 있다. 
아래는 2부터 4까지를 사건 B로 보고 전개

$$P(A_1 \cap A_2 \cap A_3 \cap A_4)$$ 
$$ = P(A_2 \cap A_3 \cap A_4) P(A_1 | A_2 \cap A_3 \cap A_4)$$
$$ = P(A_3 \cap A_4)P(A_2 | A_3 \cap A_4) P(A_1 | A_2 \cap A_3 \cap A_4)$$
$$ = P(A_4)P(A_3| A_4)P(A_2 | A_3 \cap A_4) P(A_1 | A_2 \cap A_3 \cap A_4)$$
다른 버전

A1을 조건부 확률로 생각하면 아래와 같이 전개 
더이상 이어지지가 않는다. 왜 그렇지?? 왜 큰걸 잡아야되지??

$$P(A_1 \cap A_2 \cap A_3 \cap A_4)$$ 
$$ = P(A_1)P(A_2 \cap A_3 \cap A_4 | A_1) 
$$


문제 52장의 플레잉 카드가 있다
한장씩 5번 뽑을때  9,4,a,4,7이 나올 확률은 ??

모든 가능한 경우는 순서를 고려하여 52P5이다. 

순서대로 뽑는것을 각 사건을 순서대로 A,B,C,D,E라고 하면, 일단 비복원 추출이기 때문에 모든 사걱은 독립사건이 아니다. 

$$
P( [A=9] \cap [B=4] \cap [C=a] \cap [D=4] \cap [E=7] )
$$

$$
= P( [A=9] \cap [B=4] \cap [C=a] \cap [D=4] )P([E=7]| [A=9] \cap [B=4] \cap [C=a] \cap [D=4]) 
$$

$$\cdots$$
$$=P( [A=9])P([B=4]| [A=9]) P([C=a]| [A=9] \cap [B=4]) P([D=4]| [A=9] \cap [B=4] \cap [C=a]) P([E=7]| [A=9] \cap [B=4] \cap [C=a] \cap [D=4]) 
$$


처음에 9를 뽑을 확률 $P( [A=9])  = 4/ 52$ 
사건 A에서 9를 뽑고 난뒤에 B에서 4를 뽑을 확률 $P([B=4]| [A=9]) = 4/ 51$ 
앞선 사건이 일어난 조건하에 사건 C에서 a를 뽑을 확률 
$P([C=a]| [A=9] \cap [B=4]) = 4 / 50$

앞선 사건이 일어난 조건하에 사건 D에서 4를 뽑을 확률 
$P([D=4]| [A=9] \cap [B=4] \cap [C=a]) = 3/ 49$

앞선 사건이 일어난 조건하에 사건 E에서 7를 뽑을 확률 
$P([E=7]| [A=9] \cap [B=4] \cap [C=a] \cap [D=4]) = 4/48$

## 전체 확률의 법칙(Law of Total Probability)

전체 확률의 법칙은 베이즈 정리를 이해하기 위한 개념이다. 

표본 공간 S를 n개로 분할하고 나눠진 표본공간 $s_i$가 있다. ($P(s_i) >= 0, i =1, \cdots ,n$)

S의 임의의 사건 A에 대해 아래식이 성립한다.

$$P(A) = \Sigma_{i =1}^{n}P(s_i \cap A) = \Sigma_{i =1}^{n} P(s_i)
{P(A |s_i)}{} $$

## 베이즈 정리

다양한 분야에 걸쳐 존재하는 확률 자체를 둘러싸고 벌어지는 대립이 있다. 
대립의 중심에는 빈도론과 베이즈론이다. 둘의 차이는 확률을 미리상정하는가 하지 않는가이다. 

여기 두 종류 동전이 있다고 하자. 한 동전은 '진짜 동전'으로 앞면 또는 뒷면이 나올확률이 동등하게 50%이다. 한 동전은 '가짜 동전'으로 앞면이 나올 확률이 80%이고 뒷면이 나올 확률은 20%이다. 한 동전이 진짜 동전인지 가짜 동전인지 판단하려고 할때, 빈도론의 관점과 베이즈론의 관점으로 해석해보자.

### 빈도론 

피셔와 같은 사고방식의 빈도론을 믿는 통계학자는 만약 10번 동전을 던져 모두 앞면이 나왔다면 이 동전을 진짜 동전이라고 믿을까?

진짜 동전이라고 가정하면, 위의 사건은 $1/2^{10}=0.10%$이다.
$0.10$%라는라는 확률은 바로 P-Value 값이다. 다시 말해, 이런 기적 같은 확률이 일어났다고 생각하기보다는 진짜 동전이라는 가정을 부정하는 것이 합당하다고 판단한다. 

반대로 가짜 동전이라고 가정하면, 위의 사건은 $\cfrac {8}{10}^{10}=10.74$%, 즉  P-Value 값이 10%로 기적이라고 말할 수준이 아니다. 
결과적으로 진짜 동적이라는 가정을 부정되고 가짜 동전이라는 가정이 타당성을 얻게 된다.

빈드론은 확률을 몇 번중 몇번의 빈도로 파악한다. 동전을 1만번 정도 던진다고 확장해서 생각하면, 진짜 동전을 던져 앞면이 8000번이 나올 확률 P-Value와 가짜 동전을 던져 앞면이 5000번 나올확률  P-value 는 모두 현저하게 낮다. 

$10000^C_{8000} \cfrac {1}{2}^{8000}\cfrac {1}{2}^{2000}$
$10000^C_{5000} \cfrac {8}{10}^{5000}\cfrac {2}{10}^{5000}$

### 베이즈

베이즈 입장에서는 동전을 분별할때, 아무 정보도 없는 시점에서 어느 정도의 확률로 이 동전은 진짜인가 가짜인가를 생각한다. 

아무 정보도 없는 이 시점의 확률을 사전 확률이라 한다. 사전확률은 아무 값으로 설정해도 상관 없다. 

일단 여기서 주어진 동전이 진짜일 확률이 50% 가짜일 확률이 50%라고 생각하자. 그리고 10번 던져 10번 앞면이 나왔다고 하자. 

먼저 동전이 진짜인 경우를 생각한다면, 마찬가지로 $(1/2)^{10}=0.10%$
반대로 가짜의 경우를 생각한다면, $\cfrac {8}{10}^{10}=10.74$이다. 

여기서 부터 베이즈 입장의 계산 방법은 조금 다르다. 
베이즈는 진짜인 경우와 가짜인 경우 등 각각의 상황에서 사전 확률과 조건부확률의 곰셈을 한다. 

* 진짜동전의 사전확률(50%) * 진짜동전인 경우 10번 모두 앞면이 나오는 조건부 확률 (0.10%) = 0.05%

* 가짜동전의 사전확률(50%) * 가짜동전인 경우 10번 모두 앞면이 나오는 조건부 확률 (10.74%) = 5.37%

좀 더 자세히 설명하자면 위에 두 확률의 합은 5.42%인데 이것은 동전을 던지기전에 동전이 진짜인지 가짜인지 50%인 상황에서 10번 연속 앞면이 나올 확률을 말한다. 

하지만, 동전이 10번 연속 앞면이 나온 상태에서 동전이 10번 연속 앞면이 될 확률은? 하고 물으면 당연히 100%이다. 그러니까 동전이 10번 연속 앞면이 나온 결과 상태에서 동전이 진짜일 확률은 하고 물으면 마땅히 100%가 되어야 하는 5.42%라는 확률에서 차지하는 0.05%의 확률의 비유을 생각하면 되고, 가짜일 확률은 5.42%에서 5.37%를 생각하면 된다. 

동전이 10번 연속 앞면이 나온상태에서 동전이 진짜일 확률은 $\cfrac {0.05}{5.42}$ =1%이고 동전이 까자일 확률은 $\cfrac {5.37}{5.42}$ = 99%이다.

즉 10번 모두 앞면이 나온 데이터를 근거로 99.10%의 확률로 가짜 동전이라고 파악한다. 이와 같이 사전확률과 데이터에 근거해 산출된 확률을 사후 확률이라고 한다.

### 빈도론 & 베이즈 정리

빈도론자들은 베이즈론자들에게 사전 확률을 설정하는것이 이상하다고 지적한다. 사전 확률에 따라 계산된 사후 확률이 달라지는데 이게 무슨 의미가 있는가 라고 지적한다. 

이런 약점이 있어 빈도론은 실패가 용납이 안되는 분야인 의학과 같은 보수적인 분야에서 많이 쓰인다. 실수가 용납되지 않는 상황에서 효과가 있을지 없을지 몰라도 확률은 반반이니, 그냥 ~ 하는 사전확률은 절대 용납이 안된다.

이러한 한계점이 있지만 베이즈적 사고는 연역적 추론에 궁합이 좋다. 사전확률이라는 가정을 두면, 데이터로부터 무엇을 알수 있을까 라는 연역이 가능해진다. 

특정 모델 또는 이론을 가정하고, 데이터를 분석하는 경제학은 베이즈 사고와 매우 궁합이 좋다.  


























<!--stackedit_data:
eyJoaXN0b3J5IjpbLTkwNjcwMzgxXX0=
-->