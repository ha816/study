# Overview

엘라스틱서치는 내부적으로 루씬을 통해 검색기능을 수행한다. 루씬의 동작 과정은 고도로 추상화되어 제공되기 때문에 사용자들은 루씬의 존재를 눈치채지 못할 수도 있다. 하지만 루씬의 세부적인 동작 원리를 이해하고 나면 엘라스틱 서치를 이해하는데 큰 도움이 된다. 이번 장에서는 루씬 라이브러리에 대해 알아보자

# 클러스터 관점에서 구성요소 

엘라스틱서치는 기본적으로 클러스터란 단위로 데이터를 제공한다. 클러스터는 하나 이상의 물리적인 노드로 구성되며 각 노드는 모두 데이터 색인 및 검색 기능을 제공하는 일종의 물리적 서버이기도 하다. 즉 노드는 물리적 서버를 뜻하며 다수의 서버가 모여 하나의 클러스터를 구성한다. 

엘라스틱 서치의 최상위 개념인 클러스터로 부터 최하위 개념인 세그먼트까지 하향식으로 살펴보도록 하자.

## 클러스터 

클러스터는 노드(물리적 서버)들의 집합이다. 같은 클러스터 내부의 데이터민 서로 공유가 가능하기 때문에 연관된 노드들끼리 하나의 클러스터로 구성하는 것이 매우 중요하다. 

같은 클러스토로 묶일 노드들은 같은 반드시 같은 클러스터 이름을 가져야 한다. (엘라스틱서치는 이름으로 같은 클러스터인지 아닌지 판별한다)

같은 클러스터에 속한 노드들은 평소 데이터 색인이나 검색 작업을 함께 수행하게 되고 장애가 발생했을때도 데이터 복구를 위해 서로 협력해서 복구한다.

>Cross Cluster Search
>실무에서 업무를 하다보면 데이터 성격에 따라 다수의 클러스터를 운영하게 된다. 데이터가 커지고 복잡해지면 필연적으로 다수의 클러스터를 함께 검색해야하는 일도 빈번히 발생한다.
>엘라스틱서치에서는 이처럼 다양한 필요에의해서 다수의 클러스터를 한번에 검색할 수 있는 기능을 제공하는데 그것이 Cross Cluster search다. 

## 노드 

실행 중인 엘라스틱 서치를 노드라고 부른다. 좀더 정확하게는 다수의 물리 서버에 엘라스틱 서치를 설치하고 실행된 엘라스틱서치 인스턴스를 노드라고 한다.

노드는 클러스터를 이루는 구성원이며 실제 데이터를 가지고 있는 단일 서버이기도 하다. 실행 시 노드는 클러스터에 의해  UUID(Universally Unique IDentifier)가 할당되고 클러스터 내에서는 할당된 UUID로 서로를 식별한다. 기본값으로 부여되는 UUID를 원치 않는다면 직접 이름도 설정할 수 있다. 같은 클러스터 내부에서 유일한 노드를 식별하는 것은 매우 중요하기 때문에 신중해질 필요가 있다. 

같은 클러스터 내부에 존재하는 모든 노드는 서로 다른 노드와 수시로 정보를 주고 받는다. 기본적으로 모든 노드는 마스터 노드와 데이터 노드의 역할을 동시에 수행하도록 설정되어 있는데, 실제 운영에서는 역할에 따라 노드를 구분하는 것이 좋다. 

> Written with [StackEdit](https://stackedit.io/).
<!--stackedit_data:
eyJoaXN0b3J5IjpbNjUzNzQ1MDQsLTEzMTAyNDMyNCw3NjM5Nj
c4MjksLTE0MTgxOTA4NDcsLTE5Mzk2MDY2NjIsMTg3NDc2ODU4
MSwxODU3MDQyMDIzLDE5ODg3MTQ0MDddfQ==
-->