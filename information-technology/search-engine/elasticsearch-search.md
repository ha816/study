# Overview

엘라스틱 서치는 인덱스에 저장된 문서를 검색하도록 다양한 검색 기능을 제공한다. 특정 문장이 검색어로 요청되면 분석기를 통해 분석된 토큰의 일치 여부를 판단해서 그 결과에 점수(score)를 매긴다. 이를 기반으로 순서를 적용해 결과를 사용자에게 최종적으로 출력하게 된다. 

검색의 대상이 되는 필드는 분석이 되는 Text 타입의 유형이 될 수도 있고 분석이 되지 않는 Keyword 타입의 유형이 될수도 있다. 

엘라스틱 서치에서는 다양한 검색 조건을 만족하기 위해 QueryDSL이라는 특수한 쿼리 문법을 제공한다. 

# 검색 API

문장은 색인 시점에 term(텀)으로 분해된다. 토크나이저가 나눈 토큰을 토큰 필터로 처리하고 나면 그것이 바로 term이다. 

엘라스틱서치는 색인 시점에 분석기로 분석된 텀을 역색인 구조로 만들어 내부적으로 저장한다. 검색 시점에는 Keyword 타입과 같은 분석이 불가능한 데이터와 Text 타입과 같은 분석이 가능한 데이터를 구분해서 가능할 경우 분석기로 분석을 수행한다. 

검색 API는 기본적으로 질의(Query)를 기반으로 동작한다. 검색 질의에는 검색하고자 하는 각종 조건들을 명시할 수 있으며 동일한 조건을 URI, Request Body 검색 두 가지로 할 수 있다. 

URI 방법은 루씬에서 사용하는 전통적인 방식이고 Request Body는 RESTful API를 이용해 Request Body에 조건을 표시하는 방법이다. 

## URI

이 방식은 HTTP GET 요청을 활용하는 방식으로 파라미터를 key=value 형태로 전달한다. URL에 검색할 컬럼과 검색어를 직접 지정하면 검색이 수행된다. 파라미터로는 표현의 한계가 있어 복잡한 질의를 작성하는 것을 불가능하다. 그래도 웹브라우저를 통해 빠르게 테스트를 해볼 수 있다는 장점이 있다. 

|파라미터|기본값| 설명|
|--|--|--|
|q |  | 검색을 수행할 쿼리 문자열 조건을 지정한다.|
|df |  |쿼리에 검색을 수행할 필드가 지정되지 않았을 경우, 기본 값으로 검색할 필드를 지정한다|
|analyzer| 검색 새당 필드에 설정된 형태소 분석기|문자열을 형태소 분석할때 사용할 분석기를 지정한다.|
|analyzer_wildcard| false|와일드카드 검색 활성화여부를 지정한다.|
|default_operator|OR|두 개 이상의 검색 조건이 쿼리 문자열에 포함된 경우 검색 조건 연산자를 설정한다.|
|_source| true| 검색 결과에 문서 본문 포함 여부를 지정한다|
|sort|  |검색 결과의 정렬 기준필드를 지정한다|
|from|  |검색을 시작할 문서의 위치를 지정한다|
|size|  |반환할 검색 결과 갯수를 설정한다.|

q 옵션에는 기본적으로 '필듬'


# Query DSL



> Written with [StackEdit](https://stackedit.io/).
<!--stackedit_data:
eyJoaXN0b3J5IjpbLTEyNzI1MTg0NzQsLTMwNjc4NjgxNCwxMT
c2MTE4NTYwLDIwNzExNDU3OTYsNTkzNjYzMTA4XX0=
-->