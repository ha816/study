# Overview

일반적으로 개발환경과 운영환경은 하드웨어적으로 큰 차이가 있다. 하드웨어 성능이나 운영체제 설정이 다를 경우 동일한 결과를 보장하지 않기 때문에 개발환경에서 클러스터를 구축하고 얻은 데이터를 운영환경에 그대로 사용해서는 안된다. 개발 완료 후 반드시 운영환경에서 재확인 하는 과정이 필요하다. 

엘라스틱서치는 운영환경이라고 판단되면 실행시 부트 스트랩(Bootstrap)이라는 과정으로 잘못된 설정이나 문제점을 친절히 알려준다. 이를 통해 일반적인 설정 오류는 방지할 수 있다. 하지만 시간이 흘러 데이터가 많아지면 잠재되어 있던 문제가 나타날것이다. 처음 시스템을 구축할때 최적화가 되었더라도 데이터의 종류와 양에 따라 계속 답이 달라질 수 있으므로 주요 포인트들을 주기적으로 확인해야 한다. 

# 노드 부트스트랩 과정의 이해

엘라스틱서치에는 부트스트랩이라는 과정이 있다. 그리고 엘라스틱서치 노드는 최초 실행시 항상 부트스트랩 체크라는 과정을 거친다. 이 과정이 왜 필요하고 그리고 그 과정에서 어떤 일이 일어나는지 알아보자.

## 부트스트랩 과정이 필요한 이유

과거게은 엘라스틱서치 설정 중 일부가 잘못됬거나 필수적인 리소스 할당이 되지 않으면 단순히 경고(Warning) 메세지를 로그에 출력하는 방식을 택했다. 그러다 보니 경험 없는 대다수의 운영자는 잠재되어 있는 문제의 심각성을 인지못하고 그냥 넘어가기가 부지기수 였다. 

그런 이유로 최신 버전에서는 운영시 발생가능한 문제점을 미연에 방지하기 위해 좀 더 강력한 검사를 수행하게 됬고 이러한 과정이 부트스트랩 체크(Bootstrap Checks)라 한다. 

부트스트랩 과정에서 필수 설정이 잘못된 경우, 잘못된 사실을 사용자에게 알리고 정상적으로 수정될때 까지 엘라스틱서치를 강제 종료하여 필수 설정이 완료되어야만 엘라스틱서치가 실행되도록 강제한다. 

사용자는 간단한 테스트를 하고 싶을 뿐인데 가끔 강제적인 부트스트랩 때문에 환경설정에 더 많은 시간을 할애하게 될 경우가 있다. 그래서 엘라스틱서치는 내부적으로 개발모드와 운영모드 두 가지의 개념이 존재한다. 

개발모드(Development Mode)
: 실행시 IP 주소가 루프백으로 설정된 경우, 엘라스틱서치는 개발모드로 실행된다고 판단한다. 개발모드로 실행될 경우, 부트스트랩 체크과정이 무시된다. 개발 모드로 동작하면 로컬에서 동작하기 때문에 다른 노드와 클러스터를 구성할 수 없다. 말 그대로 개발환경에서 테스트 목적으로만 사용할 수 있다.

운영모드(Product Mode)
: 운영모드는 반드시 부트스트랩 체크과정을 필수로 거친다. 그리고 실행시 IP 주소를 할당받기 때문에 당연히 다른 엘라스틱서치 노드와도 클러스터 구성이 가능하다. 클러스터에 존재하는 모든 노드는 항상 부트스트랩 체크 과정을 거치는 것이 좋다.


## 부트스크랩 체크과정 따라가기


1. 힙 크기 체크(Heap size check)
JVM옵션 중 기본 힙 크기와 최대 힙 크기 옵션이 별도로 존재한다. 이 단계에선 JVM의 기본 힙 크기와 최대 힙 크기가 같은지 검사한다.






> Written with [StackEdit](https://stackedit.io/).
<!--stackedit_data:
eyJoaXN0b3J5IjpbMTY2NTE2MTk1MCwtNDQ4MjAxOTgyLDQwMD
M5MTQ4OCwtNDExNzY5NzY4LC0xNTc3ODA4ODMxXX0=
-->